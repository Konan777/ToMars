-- скрипт для двух таблиц с характеристрикой

select ae.Name, EntityType.Name, aetest.AETestUid, EngUnit.EngUnitId,  EngUnit.Name, EngUnit.Abbreviation, CheckProcInfo.CheckProcInfoUid, TechTest.TechTestUid,
Dims.WeightEngUnitId
from ae
inner join aetype on aetype.AEUid=ae.AEUid
inner join EntityType on EntityType.EntityTypeUid=AEType.EntityTypeUid
left join AETest on AETest.AEUid=ae.AEUid
left join EngUnit on EngUnit.EngUnitId=AETest.EngUnitId
left join CheckProcInfo on CheckProcInfo.EngUnitId=EngUnit.EngUnitId
left join TechTest on TechTest.TechTestUid=CheckProcInfo.TechTestUid
left join Dims on Dims.WeightEngUnitId=EngUnit.EngUnitId

-- список dims.WeightEngUnitId совпадающий с EngUnit.EngUnitId
select distinct WeightEngUnitId from dims where dims.WeightEngUnitId in (
	select EngUnitId from EngUnit
)

-- список EngUnit.EngUnitId 
select TechTest.TechTestUid, CheckProcInfo.CheckProcInfoUid, EngUnit.EngUnitId, CheckProcInfo.CheckProcInfoUid, dims.DimsId
from TechTest
left join CheckProcInfo on CheckProcInfo.TechTestUid=TechTest.TechTestUid
left join EngUnit on EngUnit.EngUnitId=CheckProcInfo.EngUnitId
left join dims on dims.WeightEngUnitId=EngUnit.EngUnitId
where dims.DimsId!=null
