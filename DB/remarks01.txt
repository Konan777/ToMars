Noctua NF-P14R
Scythe GlideStream 140 M
be quiet! SILENT WINGS 3 [BL071]

Печати и подписи. Посмотреть на предмет работы вкладок и FPDataProvider'a

Indusoft.LDS.Client.RE

REDocViewControl - главная форма

TODO:
- Как будем именно обновлять документ?
  Если документов нет - создаем, если документы есть - проверяем наличие подтвержденных
  Если нет подтвержденных документов - удаляем старые, создаем и сохраняем новые
  В Датасете генерим рандомные значения
- Как будут работать кнопки OK/Cancel?

Новая колонка в таблице операций:
---------------------------------
Indusoft.LDS.Client.AE\Features\AEBatch\Controllers\AEBatchOpControlViewController.cs
	^^^Таблицу операций заполняем InitByBatch

AEBatchOp - добавить поле
AEBatchOpDocs - добавить поле состояния

Indusoft.LDS.Server.Services.AE\AEDataService
	добавить метод для получения списка доукментов операции с состоянием каждого

Indusoft.LDS.Server.Services.AE\AEDataService -> FillAEBatchOp
	дернуть метод для всех документов операции
	по каждой операции выставить статус


--CREATE FUNCTION [dbo].[SampleArchiveOperation_Get2]
CREATE FUNCTION [dbo].[GetAEBatchOpDocsState]
(
	@AEBatchOpGuids GuidList READONLY
)
RETURNS TABLE
AS
	RETURN

	select AEBatchOpUid, dbo.[AEBatchOpDocs].REDocReportUid, dbo.[REDocReportLogDoc].[State]
	from dbo.[AEBatchOpDocs]
	inner join dbo.[REDocReportLog] on dbo.[REDocReportLog].REDocReportUid=dbo.[AEBatchOpDocs].REDocReportUid
	inner join dbo.[REDocReportLogDoc] on dbo.[REDocReportLogDoc].REDocReportLogUid=dbo.[REDocReportLog].REDocReportLogUid
	where dbo.[AEBatchOpDocs].AEBatchOpDocsUid in (SELECT [uid] FROM @AEBatchOpGuids)
	--where dbo.[REDocReportLogDoc].State=1 -- Indusoft.LDS.Client.FP\NotifyOfDefect\ConfirmNodControl -> confirmed

        [SqlQuery(@"SELECT * FROM [dbo].[SampleArchiveOperation_Get2] (@groups)")]
        public abstract List<SampleArchiveOperation> GetSAOpsForGroups([ParamTypeName("GuidList")]Guid[] groups);

        [SqlQuery(@"SELECT AEBatchOpUid, REDocReportUid, [State] FROM [dbo].[GetAEBatchOpDocsState] (@AEBatchOpGuids)")]
        public abstract List<AEBatchOpDocs> GetAEBatchOpDocsState([ParamTypeName("GuidList")]Guid[] AEBatchOpGuids);
