Нужно допилить хранимки, чтобы не удалялись данные с неактивных профилей. Иначе грохнем то, что не можем перегрузить.
Done: GaProfile, VkontakteProfile, CallTouchProfile
ALTER TABLE [core].[FacebookProfiles]
ALTER TABLE [core].[OkProfiles]
ALTER TABLE [core].[AdWordsProfiles]
ALTER TABLE [core].[DirectProfiles]
ALTER TABLE [core].[YandexDisplayProfiles]
ALTER TABLE [core].[YmProfiles]

	IF @cleanup = 1 
	BEGIN
		if CHARINDEX('PROFILEID', UPPER(@columns))>0 AND @currentProfileId>0 BEGIN
			SET @statement = '
			DECLARE @endDatePlusOneDay DATE
			SELECT @endDatePlusOneDay = DATEADD(DAY, 1, @endDate)
			DELETE		'+@tableAndSchema+'
			WHERE		['+@cleanupFilterColumn+'] >= @startDate AND ['+@cleanupFilterColumn+'] < @endDatePlusOneDay
				AND ProfileId='+CAST(@currentProfileId AS NVARCHAR)
		END
		ELSE BEGIN
			SET @statement = '
			DECLARE @endDatePlusOneDay DATE
			SELECT @endDatePlusOneDay = DATEADD(DAY, 1, @endDate)
			DELETE		'+@tableAndSchema+'
			WHERE		['+@cleanupFilterColumn+'] >= @startDate AND ['+@cleanupFilterColumn+'] < @endDatePlusOneDay'
		END 

STRING_SPLIT

var dataTable = new DataTable();
dataTable.TableName = "dbo.IntsTTV";
dataTable.Columns.Add("Id", typeof(int));
dataTable.Rows.Add(1); // Id of '1' is valid for the Person table

SqlParameter parameter = new SqlParameter("UserIds", SqlDbType.Structured);
parameter.TypeName = "dbo.IntsTTV";
parameter.Value = dataTable;
var res = _db.Database.SqlQuery<string>("EXEC dbo.GetUsers @UserIds", parameter).ToList();
